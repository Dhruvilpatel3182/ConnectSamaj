{% extends "base.html" %}
{% block content %}



<div class="dashboard-header" style="text-align: center; margin-bottom: 30px;">
    <h1>Welcome to Samaj Seva! ğŸ‰</h1>
    <p class="subtitle" style="color: #666; font-size: 18px;">Community Management System</p>
</div>

<!-- User Info Card -->
<div class="card" style="background: linear-gradient(135deg, #0b6 0%, #084 100%); color: white;">
    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
        <div>
            <h2 style="margin: 0; color: white;">Welcome, {{ session.username }}! ğŸ‘‹</h2>
            <p style="margin: 5px 0 0 0; opacity: 0.9;">
                <strong>Role:</strong> {{ session.role|title }}
                {% if session.village %}
                â€¢ <strong>Village:</strong> {{ session.village }}
                {% endif %}
            </p>
        </div>
        <div style="background: rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 10px;">
            <small>Last Login: Today</small>
        </div>
    </div>
</div>

<!-- Statistics Cards -->
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #0b6 0%, #084 100%); color: white;">
        <div style="font-size: 32px; margin-bottom: 10px;">ğŸ </div>
        <h3 style="margin: 0; color: white;">Families</h3>
        <p style="font-size: 32px; font-weight: bold; margin: 10px 0;">{{ families_count }}</p>
        <small>Total Families</small>
    </div>
    
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white;">
        <div style="font-size: 32px; margin-bottom: 10px;">ğŸ‘¥</div>
        <h3 style="margin: 0; color: white;">Members</h3>
        <p style="font-size: 32px; font-weight: bold; margin: 10px 0;">{{ members_count }}</p>
        <small>Total Members</small>
    </div>
    
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white;">
        <div style="font-size: 32px; margin-bottom: 10px;">ğŸ“…</div>
        <h3 style="margin: 0; color: white;">Events</h3>
        <p style="font-size: 32px; font-weight: bold; margin: 10px 0;">{{ events_count }}</p>
        <small>Total Events</small>
    </div>
    
    {% if session.role == 'admin' %}
    <div class="card" style="text-align: center; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white;">
        <div style="font-size: 32px; margin-bottom: 10px;">ğŸ˜ï¸</div>
        <h3 style="margin: 0; color: white;">Villages</h3>
        <p style="font-size: 32px; font-weight: bold; margin: 10px 0;">{{ villages_count }}</p>
        <small>Managed Villages</small>
    </div>
    {% endif %}
</div>

<!-- Quick Actions Section -->
<div class="card" style="margin-top: 30px;">
    <h3>ğŸš€ Quick Actions</h3>
    
    {% if session.role == 'admin' %}
    <!-- Admin Only Actions -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <a href="{{ url_for('user_villages') }}" class="btn" style="text-align: center; padding: 20px; background: #667eea; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ˜ï¸</div>
            <strong>View Villages</strong>
            <div style="font-size: 12px; opacity: 0.9;">User View</div>
        </a>
        
        <a href="{{ url_for('families') }}" class="btn" style="text-align: center; padding: 20px; background: #0b6; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ </div>
            <strong>Manage Families</strong>
            <div style="font-size: 12px; opacity: 0.9;">Admin Only</div>
        </a>
        
        <a href="{{ url_for('view_members') }}" class="btn" style="text-align: center; padding: 20px; background: #3498db; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ‘¥</div>
            <strong>Manage Members</strong>
            <div style="font-size: 12px; opacity: 0.9;">Admin Only</div>
        </a>
        
        <a href="{{ url_for('add_family') }}" class="btn" style="text-align: center; padding: 20px; background: #9b59b6; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">â•</div>
            <strong>Add Family</strong>
            <div style="font-size: 12px; opacity: 0.9;">Admin Only</div>
        </a>
        
        <a href="{{ url_for('add_member') }}" class="btn" style="text-align: center; padding: 20px; background: #e67e22; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ‘¤</div>
            <strong>Add Member</strong>
            <div style="font-size: 12px; opacity: 0.9;">Admin Only</div>
        </a>
        
        <a href="{{ url_for('add_event') }}" class="btn" style="text-align: center; padding: 20px; background: #e74c3c; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ“…</div>
            <strong>Add Event</strong>
            <div style="font-size: 12px; opacity: 0.9;">Everyone</div>
        </a>
    </div>
    
    {% else %}
    <!-- Regular Users & Village Managers - View Only -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <a href="{{ url_for('user_villages') }}" class="btn" style="text-align: center; padding: 20px; background: #667eea; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ˜ï¸</div>
            <strong>View Villages</strong>
            <div style="font-size: 12px; opacity: 0.9;">Read Only</div>
        </a>
        
        {% if session.village %}
        <a href="{{ url_for('user_families', village_name=session.village) }}" class="btn" style="text-align: center; padding: 20px; background: #0b6; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</div>
            <strong>View Families</strong>
            <div style="font-size: 12px; opacity: 0.9;">{{ session.village }}</div>
        </a>
        {% endif %}
        
        <a href="{{ url_for('view_events') }}" class="btn" style="text-align: center; padding: 20px; background: #9b59b6; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">ğŸ“…</div>
            <strong>View Events</strong>
            <div style="font-size: 12px; opacity: 0.9;">Community Events</div>
        </a>
        
        <a href="{{ url_for('add_event') }}" class="btn" style="text-align: center; padding: 20px; background: #e74c3c; color: white;">
            <div style="font-size: 24px; margin-bottom: 10px;">â•</div>
            <strong>Add Event</strong>
            <div style="font-size: 12px; opacity: 0.9;">Everyone Can Add</div>
        </a>
    </div>
    {% endif %}
</div>

<!-- Admin Only Section -->
{% if session.role == 'admin' %}
<div class="card" style="margin-top: 30px; background: #f8f9fa; border-left: 4px solid #e74c3c;">
    <h3>âš™ï¸ Admin Tools <span style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 10px; font-size: 12px;">ADMIN ONLY</span></h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">
        <a href="{{ url_for('manage_users') }}" class="btn" style="background: #e74c3c; color: white;">ğŸ‘¥ Manage Users</a>
        <a href="{{ url_for('manage_villages') }}" class="btn" style="background: #e74c3c; color: white;">ğŸ˜ï¸ Manage Villages</a>
        <a href="{{ url_for('families') }}" class="btn" style="background: #0b6; color: white;">ğŸ  All Families</a>
        <a href="{{ url_for('view_members') }}" class="btn" style="background: #3498db; color: white;">ğŸ‘¥ All Members</a>
        <a href="{{ url_for('view_events') }}" class="btn" style="background: #9b59b6; color: white;">ğŸ“… All Events</a>
    </div>
</div>
{% endif %}

<!-- Role Information Section -->
<div class="card" style="margin-top: 30px; background: #e8f4fd; border-left: 4px solid #3498db;">
    <h3 style="color: #2980b9;">ğŸ‘¥ Your Access Level</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
        <div>
            <h4 style="color: #2980b9; margin-bottom: 10px;">
                {% if session.role == 'admin' %}
                ğŸ”§ Administrator
                {% elif session.role == 'village_manager' %}
                ğŸ‘¨â€ğŸ’¼ Village Manager
                {% else %}
                ğŸ‘¤ Community Member
                {% endif %}
            </h4>
            <ul style="margin: 0; padding-left: 20px;">
                {% if session.role == 'admin' %}
                <li>Full system access</li>
                <li>Add/edit/delete families & members</li>
                <li>Manage users & villages</li>
                <li>System configuration</li>
                {% elif session.role == 'village_manager' %}
                <li>View village data</li>
                <li>Add community events</li>
                <li>Read-only access to families</li>
                {% else %}
                <li>View your village data</li>
                <li>Add community events</li>
                <li>Read-only access</li>
                {% endif %}
            </ul>
        </div>
        <div>
            <h4 style="color: #2980b9; margin-bottom: 10px;">ğŸ“Š Your Statistics</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div style="text-align: center;">
                    <div style="font-size: 14px; color: #666;">Families</div>
                    <div style="font-size: 24px; font-weight: bold; color: #0b6;">{{ families_count }}</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 14px; color: #666;">Members</div>
                    <div style="font-size: 24px; font-weight: bold; color: #3498db;">{{ members_count }}</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 14px; color: #666;">Events</div>
                    <div style="font-size: 24px; font-weight: bold; color: #9b59b6;">{{ events_count }}</div>
                </div>
                <div style="text-align: center;">
                    <div style="font-size: 14px; color: #666;">Role</div>
                    <div style="font-size: 24px; font-weight: bold; color: #e74c3c;">{{ session.role|title }}</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Contact Admin Section for Non-Admins -->
{% if session.role != 'admin' %}
<div class="card" style="margin-top: 30px; background: #fff3cd; border-left: 4px solid #ffc107;">
    <h3 style="color: #856404;">ğŸ“ Need to Make Changes?</h3>
    <p style="margin: 0; color: #856404;">
        <strong>Only administrators can add, edit, or delete families and members.</strong><br>
        Please contact your system administrator if you need to make any changes to family or member data.
    </p>
</div>
{% endif %}

<style>
.btn {
    display: block;
    padding: 15px;
    border-radius: 10px;
    text-decoration: none;
    transition: all 0.3s ease;
    border: none;
    font-weight: 500;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.primary {
    background: #0b6;
    color: white;
}

.card {
    background: white;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
    margin-top: 20px;
    border: 1px solid #eaeaea;
}

@media (max-width: 768px) {
    .dashboard-header h1 {
        font-size: 24px;
    }
    
    .card {
        padding: 20px 15px;
    }
}
</style>
{% endblock %}